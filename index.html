<!DOCTYPE html >
<html>
  <head>
    <meta http-equiv="X-UA-Compatible" content="chrome=1" />
    <meta http-equiv="Content-Type" content="text/html;charset=utf-8" />
    <title>My Amazing SoundCloud Catalog</title>
    <script src="http://connect.soundcloud.com/sdk.js"></script>
    <link href="main.css" type="text/css" rel="stylesheet"/>
  </head>

  <body>

    <h1>My Amazing SoundCloud Catalog</h1>

    <input type="text" id="search" onchange="doSearch()" />

    <div id="catalog">
    </div>

    <div id="modal" class="hidden" onclick="hideModal()">
      <div id="track-info">
        Hello I'm some track information
      </div>

      <div id="player">
      </div>
    </div>

    <script>
      SC.initialize({
        client_id: 'd4c9ff1b3aaa3e397abbf4aa470e736e'
      });

      function Track(artwork_url) {
        this.artwork_url = artwork_url;
      }

      function doSearch() {
        var searchTerm = document.getElementById('search').value;

        // Search soundcloud for artists
        SC.get('/tracks', { q: searchTerm, license: 'cc-by-sa' }, function(tracks) {
          for(track in tracks) {
            var url = tracks[track].artwork_url;
            if(url != undefined) {
              console.log(tracks[track]);
              var trackElement = document.createElement("img");
              trackElement.setAttribute("src", url);
              var title = tracks[track].title.replace("'", "\\\'").replace("\"", "\\\"");
              trackElement.setAttribute("onclick", "showTrackInfo('" + title + "')");
              var catalog = document.getElementById("catalog");
              catalog.appendChild(trackElement);
            }
          }
        });
      };

      function showTrackInfo(title) {
        console.log(title);
        var trackInfoElement = document.getElementById("track-info");
        trackInfoElement.appendChild(document.createTextNode(title));

        var trackPlayerElement = document.getElementById("player");
        trackPlayerElement.innerHTML = "";

        var modal = document.getElementById("modal");
        modal.setAttribute("class", "");
      }

      function hideModal() {
        var modal = document.getElementById("modal");
        modal.setAttribute("class", "hidden");
      }
    </script>
  </body>

</html>